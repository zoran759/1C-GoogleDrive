
&НаКлиенте
Процедура Заполнить(Команда)
	СайтУРЛ = "accounts.google.com";
	Ресурс = "/o/oauth2/token";
	client_id = ОбщегоНазначенияСервер.Получитьclient_id();
	client_secret = ОбщегоНазначенияСервер.Получитьclient_secret();
	code	= ОбщегоНазначенияСервер.Получитьcode(); 
	redirect_uri = ОбщегоНазначенияСервер.Получитьredirect_uri();
	grant_type = "authorization_code";
	
	ЗащищенноеСоединение = Новый ЗащищенноеСоединениеOpenSSL;

	Соединение = Новый HTTPСоединение(СайтУРЛ,,,,,,ЗащищенноеСоединение);//"spreadsheets0.google.com"
	
	Заголовки = Новый Соответствие;
	Заголовки.Вставить("Content-Type","application/x-www-form-urlencoded");
	
	Запрос = Новый HTTPЗапрос(Ресурс, Заголовки); 

	Текст = "&grant_type=" + grant_type;
	Текст = Текст + "&code=" + code;
	Текст = Текст + "&client_id=" + client_id;
	Текст = Текст + "&client_secret=" + client_secret;
	Текст = Текст + "&redirect_uri=" + redirect_uri;
	Запрос.УстановитьТелоИзСтроки(Текст, КодировкаТекста.UTF8);

	Ответ = Соединение.ОтправитьДляОбработки(Запрос);
	СтрокаОтвета = Ответ.ПолучитьТелоКакСтроку();
	
	Соотвествие		= ОбщегоНазначенияСервер.UnJSON(СтрокаОтвета);
	refresh_token = Соотвествие.Получить("refresh_token");
	ОбщегоНазначенияСервер.УстановитьЗначениеКонстантыrefresh_token(refresh_token);
КонецПроцедуры
